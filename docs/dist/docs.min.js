"use strict";let e=!1;var t={logLevel:()=>e?1:0,setTrace:t=>e=t,regex:{attrs:/rbs-(.*?)="(.*?)"/g,whitespace:/\s/g},attrs:{watch:"rbs-watch",method:"rbs-method",ref:"rbs-ref"}};const{attrs:r}=t;let n=1;var o={dom:{recordState(e){const t=document.activeElement,n=t.getAttribute(r.ref);return e.contains(t)&&n?{ref:n,style:t.getAttribute("style"),scrollTop:t.scrollTop,scrollLeft:t.scrollLeft,selectionStart:t.selectionStart}:null},isTextNode:e=>e.nodeType===Node.TEXT_NODE,restoreState(e,t){if(!t)return;const r=this.findRef(e,t.ref);if(r){if(r.focus(),t.selectionStart){const e="TEXTAREA"===r.tagName?t.selectionStart:t.selectionStart+1;r.setSelectionRange(e,e)}r.scrollTop=t.scrollTop,r.scrollLeft=t.scrollLeft,t.style&&r.setAttribute("style",t.style)}},findRef:(e,t)=>e.getAttribute(r.ref)===t?e:e.querySelector(`[${r.ref}="${t}"]`),findRefs(e){const{ref:t}=r;return Array.from(e.querySelectorAll(`[${t}]`)).reduce((e,r)=>{const n=r.getAttribute(t),o=e[n];return e[n]=o?[o].concat(r):r,e},{})},findMethod:e=>document.querySelector(`[${r.method}="${e}"]`),findWatcher:e=>document.querySelector(`[${r.watch}="${e}"]`),propStr:e=>Object.entries(e).map(([e,t])=>"number"==typeof t?`${e}=${t}`:`${e}="${t}"`).join(" "),wrapWatcher(e,t,n){const{tag:o,...a}={tag:"span",...n};return`<${o} ${this.propStr(a)} ${t.length?"":"style='display:none;'"} ${r.watch}="${e}">${t}</${o}>`},getShadow(e){const t=document.createElement("div");return t.innerHTML=e,t}},debounce(e,t=0,r=!1){let n=null;return function(){const o=r&&!n,a=()=>e.apply(this,arguments);clearTimeout(n),n=setTimeout(a,t),o&&a()}},nextTick:()=>new Promise(e=>{setTimeout(e,0)}),intersects:(e,t)=>Object.keys(t).filter(t=>t in e),registerHelpers(e,t){Object.entries(t).forEach(([t,r])=>e.registerHelper(t,r))},registerPartials(e,t,r){Object.entries(r).forEach(([r,n])=>{e.registerPartial(r,n.template),["methods","partials","data"].forEach(o=>{if(!(o in n))return;const a=this.intersects(t[o],n[o]);a.length&&e.log(2,`ReBars: partial ${r} has conflicting ${o} keys`,a)}),n.data&&Object.assign(t.data,n.data),n.methods&&Object.assign(t.methods,n.methods),n.helpers&&this.registerHelpers(e,n.helpers)})},bind:(e,t,...r)=>Object.keys(e).reduce((n,o)=>(n[o]=e[o].bind(t,...r),n),{}),shouldRender:(e,t)=>e.some(e=>t.some(t=>e.match(t))),randomId:()=>n++},a={create(e,t,r=!1){let n=[];const a=o.debounce(()=>{t(n),n=[]}),s=e=>{n.includes(e)||n.push(e),a(n)};return function e(t,n=[]){return new Proxy(t,{get:function(t,o){const a=Reflect.get(...arguments);return a&&"object"==typeof a&&["Array","Object"].includes(a.constructor.name)?e(a,n.concat(o)):(r&&s(n.concat(o).join(".")),a)},set:function(e,t,r){const o=Reflect.set(...arguments),a=n.concat(t).join(".");return s(a),o},deleteProperty:function(e,t){const r=Reflect.deleteProperty(...arguments),o=n.concat(t).join(".");return s(o),r}})}(e)}};const{attrs:s}=t;var c={register({instance:e,template:r,store:n,scope:c}){e.registerHelper("ref",t=>new e.SafeString(`${s.ref}="${t}"`)),e.registerHelper("buildPath",(function(...e){return e.pop(),Array.from(e).join(".")})),e.registerHelper("on",(function(...t){const{hash:r}=t.pop(),a=o.randomId(),i=this;return n.handlers[a]=[],Object.entries(r).forEach(([s,l])=>{o.nextTick().then((function(){const d=o.dom.findMethod(a);if(!d)return;l in c.methods||e.log(3,`ReBars: "${l}" is not a method.`,r,d);const h=e=>{const r={event:e,$app:c.$app,$refs:o.dom.findRefs.bind(null,c.$app),$nextTick:o.nextTick,rootData:c.data};r.methods=o.bind(c.methods,i,r),r.methods[l](...t)};n.handlers[a].push({$el:d,handler:h,eventType:s}),d.addEventListener(s,h)}))}),new e.SafeString(`${s.method}="${a}"`)})),e.registerHelper("watch",(function(...r){const{fn:s,hash:c}=r.pop(),i=o.randomId(),l={path:r.filter(e=>"string"==typeof e),render:()=>s(this)};if(!r.length){const e=a.create(this,e=>{l.path=e},!0);s(e)}return o.nextTick().then(()=>{const a=o.dom.findWatcher(i);a&&(n.renders[i]={...l,$el:a},r.forEach(t=>{"string"!=typeof t&&e.log(3,"ReBars: can only watch Strings",r,a)}),e.log(t.logLevel(),"ReBars: watching",l.path,a))}),o.dom.wrapWatcher(i,s(this),c)}))}};const{attrs:i,regex:l}=t;function d(e,t){const r=e.replace(l.attrs,""),n=t.replace(l.attrs,"");return o.dom.getShadow(r).isEqualNode(o.dom.getShadow(n))}var h={canPatch:e=>e.children.length&&e.children.length>1&&Array.from(e.children).every(e=>e.getAttribute(i.ref)),hasChanged:(e,t)=>!d(e.innerHTML,t),compare({$target:e,html:r,instance:n,store:a}){const s=o.dom.getShadow(r),c=Array.from(s.children),l=t.logLevel();Array.from(e.children).forEach(e=>{const t=o.dom.findRef(s,e.getAttribute(i.ref));t?d(t.innerHTML,e.innerHTML)||(n.log(l,"ReBars: updating",e,t),e.replaceWith(t.cloneNode(!0))):(n.log(l,"ReBars: removing",e),e.remove())}),c.forEach((t,r)=>{o.dom.findRef(e,t.getAttribute(i.ref))||(n.log(l,"ReBars: adding",t),e.append(t.cloneNode(!0)))}),c.forEach((t,r)=>{const n=e.children[r];n.getAttribute(i.ref)!==t.getAttribute(i.ref)&&n.replaceWith(t.cloneNode(!0))})}},u={paths({changed:e,store:r,instance:n}){Object.entries(r.renders).filter(([t,r])=>o.shouldRender(e,r.path)&&o.dom.findWatcher(t)).forEach(([e,a])=>{const s=o.dom.findWatcher(e);if(!s)return;const c=a.render(),i=o.dom.recordState(s);return h.hasChanged(s,c)?h.canPatch(s)?(n.log(t.logLevel(),"ReBars: patching",a.path,s),h.compare({$target:s,html:c,instance:n,store:r}),void o.dom.restoreState(s,i)):(a.path.find(e=>e.endsWith(".length"))&&n.log(2,"ReBars: add a {{ ref someUniqueKey }} to each to avoid re-rendering the entire Array",a.path,s),s.style.display=""===c?"none":"",s.innerHTML=c,o.dom.restoreState(s,i),void n.log(t.logLevel(),"ReBars: render",a.path,s)):void 0})}},f={start(e,{renders:r,handlers:n}){const o=new MutationObserver(([e])=>{e.removedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){const o=e.getAttribute(t.attrs.watch),a=e.getAttribute(t.attrs.method);o&&delete r[o],a&&(n[a].forEach(e=>{e.$el.removeEventListener(e.eventType,e.handler)}),delete n[a])}})});return o.observe(e,{attributes:!0,childList:!0,subtree:!0}),o}},g={app({helpers:e={},template:r,data:n={},methods:s={},partials:i={},watch:l={},Handlebars:d=window.Handlebars,trace:h=!1}){const g=d.create(),m=g.compile(r),p={renders:{},handlers:{}};return t.setTrace(h),o.registerHelpers(g,e),{store:p,instance:g,render(e){const d=document.querySelector(e);if(!d)return g.log(3,`ReBars: document.querySelector("${e}") could not be found on the document`);const h={$app:d,methods:s,data:n};c.register({instance:g,template:r,store:p,scope:h}),o.registerPartials(g,h,i),h.data=Object.entries(h.data).reduce((e,[t,r])=>("function"==typeof r&&e.hasOwnProperty(t)&&(e[t]=r.bind(h)),e),n),h.data=a.create(n,e=>{g.log(t.logLevel(),"ReBars: change",e),u.paths({changed:e,store:p,instance:g}),Object.entries(l).forEach(([t,r])=>{o.shouldRender(e,[t])&&r.call(h)})}),f.start(d,p),d.innerHTML=m(h.data)}}}};window.Prism=window.Prism||{},window.Prism.manual=!0,window.ReBars=g,document.querySelectorAll(".language-html").forEach(e=>{e.innerText.includes("<script src")||(e.classList.remove("language-html"),e.classList.add("language-handlebars"))}),Prism.highlightAll(),Array.from(document.querySelectorAll("code.language-javascript .token.string")).filter(e=>{const t=e.innerText.trim();return(t.startsWith("<")||t.startsWith("{"))&&(t.endsWith(">")||t.endsWith("}"))}).forEach(e=>{e.innerHTML=Prism.highlight(e.innerText,Prism.languages.handlebars,"handlebars")}),function(){const e=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target.dataset&&e.target.dataset.anchor,r=document.querySelector(`.side-bar-nav a[href="${t}"]`);console.log(r,t),r&&(e.intersectionRatio>0?r.classList.add("active"):r.classList.remove("active"))})});document.querySelectorAll("div[data-anchor]").forEach(t=>{e.observe(t)});const t=window.location.hash?document.querySelector(window.location.hash):null;t&&t.scrollIntoView()}(),Array.from(document.querySelectorAll(".content > h1")).map(e=>e.nextSibling.nextSibling).forEach(e=>e.classList.add("intro"));
