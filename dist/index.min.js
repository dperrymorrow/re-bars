(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a=a||self,a.Vbars=b())})(this,function(){'use strict';function a(a="MSG"){const b=Array.isArray(a)?a:[a],c=(a,c,f)=>{a=`${d[c]} ${a}`;const g=b.slice(0,2).concat([a]).map(a=>`%c ${a} `).join(""),h=[e[c][0]];1<b.length&&h.push(e[c][1]),h.push(e.msg);const i=[g].concat(h),j=null===f?console.log:console.groupCollapsed;j(...i),f&&(console.log(f),console.groupEnd())};return{warn:(a,b=null)=>c(a,"warn",b),error:(a,b=null)=>c(a,"error",b),log:(a,b=null)=>c(a,"log",b)}}function b({templateFn:a,proxyData:b,eventHandlers:c}){function d(){h.innerHTML=a(b),t.log("vdom contents",h)}function e(a){i=a,d(),a.innerHTML=h.innerHTML,s.add({$root:i,$container:a,eventHandlers:c,data:b})}function f(a,d){g.keyedChildren(d).forEach(d=>{const e=a.querySelector(`[data-key="${d.dataset.key}"]`);if(!e)d.remove();else if(!e.isEqualNode(d)){const a=g.swapNodes(e,d);s.add({$root:i,$container:a,eventHandlers:c,data:b})}}),g.keyedChildren(a).forEach(a=>{const e=d.querySelector(`[data-key="${a.dataset.key}"]`);if(!e){const e=g.addChild(d,a);s.add({$root:i,$container:e,eventHandlers:c,data:b})}})}const h=document.createElement("div");let i;return{$el:h,render:d,replace:e,patch:function(a,e){d(),Array.from(h.querySelectorAll("[data-watch]")).filter(a=>e.startsWith(a.dataset.watch)).forEach(d=>{const h=a.querySelector(`#${d.getAttribute("id")}`);g.isKeyedNode(d)?(t.log(`comparing keyed arrays ${e}`,d),f(d,h)):(h.innerHTML=d.innerHTML,t.log(`patching ${e}`,d),s.add({$root:a,$container:h,eventHandlers:c,data:b}))})}}}const c={orange:"#ffc934",orangeDark:"#d38809",grey:"#073042",white:"#FFF",red:"#e95233",redDark:"#b74129",green:"#02d479",greenDark:"#0ea760",black:"#000000"},d={error:"\uD83D\uDCA5",warn:"\u26A0\uFE0F",log:"\uD83D\uDCAC"},e={msg:`background: ${c.black}; color: ${c.white}; font-weight: bold;`,warn:[`background: ${c.orangeDark}; color:${c.black}; font-weight: bold;`,`background: ${c.orange}; color:${c.black}; font-weight: bold;`],error:[`background: ${c.redDark}; color:${c.black}; font-weight: bold;`,`background: ${c.red}; color:${c.black}; font-weight: bold;`],log:[`background: ${c.greenDark}; color:${c.black}; font-weight: bold;`,`background: ${c.green}; color:${c.black}; font-weight: bold;`]},f=a("utils");var g={randomInt(a=0,b=1e3){var c=Math.floor,d=Math.ceil;return a=d(a),b=c(b),c(Math.random()*(b-a))+a},watchId(a){return`reactive-key-${a.loc.start.column}${a.loc.start.line}${a.loc.end.column}${a.loc.end.line}`},isKeyedNode(a){return!!a.children.length&&Array.from(a.children).every(a=>a.dataset.key)},keyedChildren(a){return Array.from(a.children).filter(a=>a.dataset.key)},swapNodes(a,b){const c=a.cloneNode(!0);return b.parentNode.replaceChild(c,b),c},addChild(a,b){const c=b.cloneNode(!0);return a.appendChild(c),c},setKey(a,b,c){const d=b.split(".");d.reduce((e,g,h)=>(g in e||f.warn(`${b} was not found in object`,a),h+1===d.length&&(e[g]=c),e[g]),a)}};const h=".",i=Symbol("target"),j=Symbol("unsubscribe"),k=a=>null===a||"object"!=typeof a&&"function"!=typeof a,l=a=>a instanceof RegExp||a instanceof Number,m=a=>a instanceof Date,n=(a,b)=>(b&&b.toString&&(a&&(a+=h),a+=b.toString()),a),o=(a,b)=>{for(let c;a;)c=a.indexOf(h),-1===c&&(c=a.length),b(a.slice(0,c)),a=a.slice(c+1)},p=a=>Array.isArray(a)?a.slice():Object.assign({},a),q=(a,b,c={})=>{const d=Symbol("ProxyTarget");let e,f,g=!1,q=!1,r=!1;const s=c.equals||Object.is;let t=new WeakMap,u=new WeakMap,v=new WeakMap;const w=(a,c,d,h)=>{if(!r){if(!g)return void b(n(a,c),h,d);if(g&&f&&void 0!==d&&void 0!==h&&"length"!==c){let b=f;a!==e&&(a=a.replace(e,"").slice(1),o(a,a=>{b[a]=p(b[a]),b=b[a]})),b[c]=d}q=!0}},x=(a,b)=>{let c=t?t.get(a):void 0;if(c)return c;c=new Map,t.set(a,c);let d=c.get(b);return d||(d=Reflect.getOwnPropertyDescriptor(a,b),c.set(b,d)),d},y=(a,b)=>{const c=t?t.get(a):void 0;c&&c.delete(b)},z=(a,b)=>{if(r)return a;u.set(a,b);let c=v.get(a);return void 0===c&&(c=new Proxy(a,C),v.set(a,c)),c},A=a=>(r=!0,t=null,u=null,v=null,a),B=a=>r||!0===c.ignoreSymbols&&"symbol"==typeof a,C={get(a,b,e){if(b===d||b===i)return a;if(b===j&&""===u.get(a))return A(a);const f=Reflect.get(a,b,e);if(k(f)||l(f)||"constructor"===b||!0===c.isShallow)return f;const g=x(a,b);if(g&&!g.configurable){if(g.set&&!g.get)return;if(!1===g.writable)return f}return z(f,n(u.get(a),b))},set(a,b,c,e){c&&void 0!==c[d]&&(c=c[d]);const f=B(b),g=f?null:Reflect.get(a,b,e),h=Reflect.set(a[d]||a,b,c);return f||s(g,c)||w(u.get(a),b,g,c),h},defineProperty(a,b,c){const d=Reflect.defineProperty(a,b,c);return B(b)||(y(a,b),w(u.get(a),b,void 0,c.value)),d},deleteProperty(a,b){if(!Reflect.has(a,b))return!0;const c=B(b),d=c?null:Reflect.get(a,b),e=Reflect.deleteProperty(a,b);return c||(y(a,b),w(u.get(a),b,d)),e},apply(a,b,c){var i=Math.max;const j=m(b);if(j&&(b=b[d]),!g){g=!0,j&&(f=b.valueOf()),(Array.isArray(b)||"[object Object]"===toString.call(b))&&(f=p(b[d])),e=u.get(a),e=e.slice(0,i(e.lastIndexOf(h),0));const k=Reflect.apply(a,b,c);return g=!1,(q||j&&!s(f,b.valueOf()))&&(w(e,"",f,b[d]||b),f=null,q=!1),k}return Reflect.apply(a,b,c)}},D=z(a,"");return b=b.bind(D),D};q.target=a=>a[i]||a,q.unsubscribe=a=>a[j]||a;const r=a("Event Handlers");var s={add({$root:a,$container:b,eventHandlers:c,data:d}){b.querySelectorAll("[data-handler]").forEach(e=>{const[f,g]=e.dataset.handler.split(":");let[h,...i]=f.split(".");return g in c?void e.addEventListener(h,e=>{i.includes("prevent")&&(e.stopPropagation(),e.preventDefault()),c[g]({event:e,data:d,$root:a,$container:b})}):void r.warn(`${g} not in event handlers`,c)}),b.querySelectorAll("[data-bind]").forEach(a=>{a.addEventListener("input",b=>{g.setKey(d,a.dataset.bind,b.currentTarget.value)})})}};const t=a("V-DOM");var u={create({template:a,data:c,eventHandlers:d={}}){let e;const f=window.Handlebars.create(),h=f.compile(a),i=q(c,(...a)=>{j.patch(e,...a)}),j=b({templateFn:h,proxyData:i,eventHandlers:d});return f.registerHelper("watch",(a,b)=>{const c=g.watchId(b);return`<span id="${c}" data-watch="${a}">${b.fn(i)}</span>`}),{instance:f,data:i,vDom:j,render(a){e=a,j.replace(a)}}}};return u});