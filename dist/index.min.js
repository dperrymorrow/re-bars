!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Vbars=t()}(this,(function(){"use strict";var e={findComponent:e=>document.getElementById(e),findRefs(e){return Array.from(this.findComponent(e).querySelectorAll("[data-vbars-ref]")).reduce((e,t)=>(e[t.dataset.vbarsRef]=t,e),{})},getWildCard(e){const t=e.split(".").slice(0,-1);return t.push("*"),t.join(".")},randomId:()=>"_"+Math.random().toString(36).substr(2,9),setKey(e,t,n){const r=t.split(".");r.reduce((a,o,s)=>{if(!(o in a))throw new Error(`${t} was not found in object`,e);return s+1===r.length&&(a[o]=n),a[o]},e)}},t={register({id:t,instance:r,methods:a,components:o,proxyData:s,parentData:i,props:d}){function c(){const[e,...n]=arguments,a=n.splice(-1,1);if(n.some(e=>null!==e&&"object"==typeof e))throw new Error(`must only pass primitives as argument to a handler. ${JSON.stringify(n,null,2)}`);const o={methodName:a[0].name,eventType:e,args:n};return new r.SafeString(`on${e}="vbars.handlers.${t}.${o.methodName}(${n.join(",")})"`)}window.vbars=window.vbars||{handlers:{}},window.vbars.handlers[t]={bind:(t,n)=>e.setKey(s,n,t.currentTarget.value)};const p=e=>new r.SafeString(Object.keys(e).map(t=>`data-vbars-${t}='${e[t]}'`).join(" "));r.registerHelper("debug",e=>new r.SafeString(`<pre class="debug">${JSON.stringify(e,null,2)}</pre>`)),r.registerHelper("watch",(function(t,{fn:n}){const r=e.randomId();return setTimeout(()=>{document.getElementById(r).vBarsRender=n},0),`<span id="${r}" ${p({watch:t})}>${n(s)}</span>`})),Object.keys(o).forEach(e=>{r.registerHelper(e,(function(t){return new r.SafeString(n.component({...o[e],parentData:s,props:t.hash}))}))}),r.registerHelper("isChecked",e=>e?"checked":""),r.registerHelper("ref",e=>p({ref:e})),r.registerHelper("bind",e=>new r.SafeString(`oninput="vbars.handlers.${t}.bind(event, '${e}')"`)),Object.keys(a).forEach(n=>{window.vbars.handlers[t][n]=function(){return a[n].call(a,{data:s,parentData:i,props:d,$refs:e.findRefs(t),event:event},...arguments)},r.registerHelper(n,c)})}},n={component({template:n,data:r={},components:a={},methods:o={},parentData:s={},props:i={},hooks:d={},Handlebars:c=window.Handlebars}){if(!c)throw new Error("Vbars need Handlebars in order to run!");const p=e.randomId(),f=c.create();d.created&&d.created(...arguments);const l=function e(t,n,r,a=[]){return new Proxy(n,{get:function(n,o){const s=Reflect.get(...arguments);return null!==s&&"object"==typeof s&&"methods"!==o?e(t,s,r,a.concat(o)):s},set:function(e,t){const n=Reflect.set(...arguments);return r({path:a.concat(t).join(".")}),n},deleteProperty:function(e,t){const n=Reflect.deleteProperty(...arguments);return r({path:a.concat(t).join(".")}),n}})}(p,r,({path:t})=>{Array.from(e.findComponent(p).querySelectorAll("[data-vbars-watch]")).filter(n=>{const r=n.dataset.vbarsWatch;return t===r||e.getWildCard(t)===r}).forEach(e=>{e.innerHTML=e.vBarsRender(l)})}),u=f.compile(n);if(t.register({id:p,instance:f,methods:o,components:a,proxyData:l,parentData:s,props:i}),"attached"in d){const t=setInterval(()=>{e.findComponent(p)&&(clearInterval(t),d.attached({methods:o,data:l,parentData:s,props:i,$refs:e.findRefs(p)}))},100)}return`<span id="${p}">${u(r)}</span>`}};return n}));
//# sourceMappingURL=index.min.js.map
