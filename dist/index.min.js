!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Vbars=t()}(this,(function(){"use strict";var e={isKeyedNode:e=>!!e.children.length&&Array.from(e.children).every(e=>e.dataset.vbarsKey),keyedChildren:e=>Array.from(e.children).filter(e=>e.dataset.vbarsKey),randomId:()=>"_"+Math.random().toString(36).substr(2,9),setKey(e,t,r){const n=t.split(".");n.reduce((a,o,s)=>{if(!(o in a))throw new Error(`${t} was not found in object`,e);return s+1===n.length&&(a[o]=r),a[o]},e)}};function t({id:t,templateFn:r,proxyData:n}){const a=document.createElement("div"),o=()=>a.innerHTML=r(n);function s(e,t){const r=e.cloneNode(!0);t.parentNode.replaceChild(r,t)}return{$el:a,render:o,patch:function(r){const n=document.getElementById(t);o(),Array.from(a.querySelectorAll("[data-vbars-watch]")).filter(e=>r.startsWith(e.dataset.vbarsWatch)).forEach(t=>{const r=n.querySelector(`[data-vbars-id="${t.dataset.vbarsId}"]`);e.isKeyedNode(t)?function(t,r){e.keyedChildren(r).forEach(e=>{const r=t.querySelector(`[data-vbars-key="${e.dataset.vbarsKey}"]`);r?r.isEqualNode(e)||s(r,e):e.remove()}),e.keyedChildren(t).forEach(e=>{r.querySelector(`[data-vbars-key="${e.dataset.vbarsKey}"]`)||function(e,t){const r=t.cloneNode(!0);e.appendChild(r)}(r,e)})}(t,r):s(t,r)})}}}var r={register({id:t,instance:r,methods:n,components:a,proxyData:o}){function s(){const[e,...n]=arguments,a=n.splice(-1,1);if(n.some(e=>null!==e&&"object"==typeof e))throw new Error(`must only pass primitives as argument to a handler. ${JSON.stringify(n,null,2)}`);const o={methodName:a[0].name,eventType:e,args:n};return new r.SafeString(`on${e}="vbars.handlers.${t}.${o.methodName}(${n.join(",")})"`)}window.vbars=window.vbars||{handlers:{}},window.vbars.handlers[t]={bind:(t,r)=>e.setKey(o,r,t.currentTarget.value)};const d=()=>Array.from(document.getElementById(t)).reduce((e,t)=>(e[t.dataset.vbarsRef]=t,e),{}),c=e=>new r.SafeString(Object.keys(e).map(t=>`data-vbars-${t}='${e[t]}'`).join(" "));r.registerHelper("watch",(e,t)=>{const r=`${t.loc.start.column}${t.loc.start.line}${t.loc.end.column}${t.loc.end.line}`;return c({id:r,watch:e})}),Object.keys(a).forEach(e=>{r.registerHelper(e,(function(){return new r.SafeString(a[e].render())}))}),r.registerHelper("keyed",e=>c({key:e})),r.registerHelper("isChecked",e=>e?"checked":""),r.registerHelper("ref",e=>c({ref:e})),r.registerHelper("bind",e=>new r.SafeString(`oninput="vbars.handlers.${t}.bind(event, '${e}')"`)),Object.keys(n).forEach(e=>{window.vbars.handlers[t][e]=function(){return n[e].call(n,{data:o,$refs:d(),event:event},...arguments)},r.registerHelper(e,s)})}};return{create({template:n,data:a,components:o={},methods:s={},Handlebars:d=window.Handlebars}){if(!d)throw new Error("Vbars need Handlebars in order to run!");const c=e.randomId(),i=d.create(),l=function e(t,r,n=[]){return new Proxy(t,{get:function(t,a){const o=Reflect.get(...arguments);return null!==o&&"object"==typeof o&&"methods"!==a?e(o,r,n.concat(a)):o},set:function(e,t){const a=Reflect.set(...arguments);return r({path:n.concat(t).join(".")}),a},deleteProperty:function(e,t){const a=Reflect.deleteProperty(...arguments);return r({path:n.concat(t).join(".")}),a}})}(a,({path:e})=>f.patch(e));r.register({id:c,instance:i,methods:s,components:o,proxyData:l});const u=i.compile(`<span id="${c}">${n}</span>`),f=t({id:c,templateFn:u,proxyData:l,methods:s});return{VbarsComponent:!0,instance:i,id:c,data:l,render:()=>u(l)}}}}));
//# sourceMappingURL=index.min.js.map
